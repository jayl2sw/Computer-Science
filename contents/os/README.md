# Operating System (운영체제)

> 작성자: 이재준



**목차**

* [프로세스의 구조](#프로세스의-구조)
* [Stack 영역 vs Heap 영역](#Stack-영역-vs-Heap-영역)
* [프로세스 vs 쓰레드](#프로세스-vs-쓰레드)
* [Context Switching](#Context-Switching)



## 프로세스의 구조

### code

* 컴파일 된 소스 코드가 저장되는 영역

### data

* 전역 변수/초기화된 데이터가 저장되는 영역

### heap

* 코드에서 동적으로 생성되는 데이터가 저장되는 영역

### Stack

* 임시 데이터(함수 호출, 로컬 변수 등)가 저장되는 영역

## Stack 영역 vs Heap 영역

### Stack 영역

* 함수의 호출과 관계되는 지역  변수와 매개 변수가 저장되는 영역
* stack 영역은 함수의 호출과 함께 할당되며, 함수의 호출이 완료되면 소멸.
* 푸시(push)으로 데이터를 저장하고 팝(pop)으로 데이터 반출
* LIFO (Last-In, First-Out) 방식에 따라 동작

* 장점
  * 빠른 액세스
  * 변수의 명시적 할당 해제 X
* 단점
  * 지역 변수만 가능
  * 변수 크기 조정 불가 (컴파일 타임에 크기가 결정)

### Heap 영역

* 사용자가 직접 관리 하는 메모리 영역
* 사용자에 의해 메모리 공간의 동적 할당 및 해제
  * Java, C#등은 카비지 컬렉터(GC)가 수거함
* 데이터를 항상 유지하고 싶을 때 사용
* 장점
  * 전역 변수
  * 메모리 크기 제한 X
  * 메모리 크기를 동적으로 변경할 수 있다. (런타임에 크기가 결정)
* 단점
  * 느린 액세스
  * 효율적인 공간 사용이 불가능할 때, 메모리가 조각화 되어 해제 될 수 있음
  * 메모리 관리 필수적

### Stack Overflow, Heap Overflow

* 스택은 메모리의 끝에서부터, 힙은 메모리의 앞에서부터 주소를 채워간다.
* `Stack Overflow` : 스택이 넘쳐 힙을 침범할 경우
* `Heap Overflow` : 힙이 넘쳐 스택을 침범할 경우

## 프로세스 vs 쓰레드

### 프로세스 (process)

**정의**

* "컴퓨터에서 연속적으로 실행되고 있는 컴퓨터 프로그램"
* 메모리에 올라와 **실행되고 있는 프로그램의 인스턴스**
* 운영체제로부터 **시스템 자원**을 할당받는 작업의 단위
  * CPU, 주소 공간, 독립된 메모리 영역

**특징**

* 프로세스는 각각 독립된 메모리 영역 (Code, Data, Stack, Heap)을 할당 받는다.
* 기본적으로 프로세스당 최소 1개의 스레드(메인 스레드)를 가지고 있다.
* 각 프로세스는 별도의 주소 공간에서 각각 독립적으로 실행된다.
* 프로세스간 자원 접근을 위해서는 프로세스간 통신 (IPC, inter-process communication)을 사용해야한다
  * ex) 소켓 통신, 파일 통신 etc
  
  

### **스레드 (thread)**

**정의**

* "시스템의 여러 자원을 할당받아 실행하는 **프로세스 내에서의 작업 단위**"

**특징**

* 스레드는 프로세스 내에서 **각각 Stack과 Register만 따로 할당**받고 **Code, Data, Heap의 영역은 공유**한다.

  Register
* 멀티스레드의 경우 같은 프로세스 내의 스레드끼리 힙 공간을 공유한다. (프로세스 간 접근 x)
* 한 스레드가 프로세서 자원 변경 시, 즉시 반영되어 다른 스레도도 해당 결과에 바로 접근 가능핟.



참고 |  [thread in java](https://github.com/jayl2sw/Computer-Science/tree/master/contents/programming/java)



### 멀티 프로세스 vs 멀티 스레드

**`멀티 프로세싱`**: 하나의 응용 프로그램을 여러개의 프로세스로 구성하여 각 프로세스가 하나의 작업(Task)을 처리하도록 함 

* **장점** 
  * 여러 프로세스 중 하나에 문제가 발생하더라도 다른 프로세스들에 의해 프로그램 실행에는 문제가 발생하지 않음
* **단점**
  * [Context Switching](#Context-Switching)에서의 Overhead발생
  * 프로세스 사이의 통신을 위한 IPC 필요



**`멀티 스레드`**: 하나의 응용 프로그램을 여러 개의 스레드로 구성하고 각 스레드로 하여금 하나의 작업을 처리하도록 하는 것

* **장점**
  * **시스템 자원 소모 감소 (자원의 효율성 증대)**
    * 프로세스를 생성하여 자원을 할당하는 System Call이 줄어들어 자원을 효율적으로 관리
  * **시스템 처리 비용 감소**
    * 스레드 간 데이터를 주고 받는 것이 간단해지고 시스템 자원 소모 감소
    * 스레드 사이의 작업량이 작아 Context Switching 비용 감소
  * **통신 비용의 감소**
    * 모든 스레드는 Stack 영역을 제외한 모든 메모리를 공유하기 때문에 통신 비용이 적음

* 단점
  * 설계가 어려움
  * **동기화 문제**가 발생 (자원 공유의 문제)
    * 스레드간 자원 공유는 전역 변수를 이용하므로 동시에 접근 시 충돌 발생 가능
  * 다른 프로세스에서 스레드를 제어할 수 없음
  * 하나의 스레드에 문제 발생시 전체 프로세스에 영향





## Context Switching

* 
